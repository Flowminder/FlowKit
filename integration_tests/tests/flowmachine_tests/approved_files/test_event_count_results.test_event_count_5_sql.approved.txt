SELECT subscriber,
       count(*) AS value
FROM (SELECT events.calls.msisdn AS subscriber
      FROM events.calls
      WHERE (events.calls.datetime >= '2016-01-03 00:00:00')
        AND (events.calls.datetime < '2016-01-06 00:00:00')
        AND ((   (EXTRACT(HOUR FROM events.calls.datetime) >= 22)
              OR (EXTRACT(HOUR FROM events.calls.datetime) < 4)))

      UNION ALL

      SELECT events.sms.msisdn AS subscriber
      FROM events.sms
      WHERE (events.sms.datetime >= '2016-01-03 00:00:00')
        AND (events.sms.datetime < '2016-01-06 00:00:00')
        AND ((   (EXTRACT(HOUR FROM events.sms.datetime) >= 22)
              OR (EXTRACT(HOUR FROM events.sms.datetime) < 4)))) AS u
GROUP BY subscriber