



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Logging - FlowKit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/mermaid@7.1.2/dist/mermaid.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="#095798" data-md-color-accent="#2977b8">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#audit-trails" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="FlowKit" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                FlowKit
              </span>
              <span class="md-header-nav__topic">
                Logging
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/Flowminder/FlowKit" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Flowminder/FlowKit
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Introduction" class="md-tabs__link md-tabs__link--active">
        Introduction
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="FlowKit" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    FlowKit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Flowminder/FlowKit" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Flowminder/FlowKit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../flowclient/" title="Analyst" class="md-nav__link">
      Analyst
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../developer/roadmap/" title="Developer" class="md-nav__link">
      Developer
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../cache_management/" title="Administrator" class="md-nav__link">
      Administrator
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#audit-trails" title="Audit Trails" class="md-nav__link">
    Audit Trails
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication-logs" title="Authentication Logs" class="md-nav__link">
    Authentication Logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-usage-logs" title="API Usage Logs" class="md-nav__link">
    API Usage Logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flowmachine-usage-logs" title="FlowMachine Usage Logs" class="md-nav__link">
    FlowMachine Usage Logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-logging-cycle" title="Complete Logging Cycle" class="md-nav__link">
    Complete Logging Cycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-and-monitoring-logs" title="Managing and Monitoring Logs" class="md-nav__link">
    Managing and Monitoring Logs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Logging</h1>
                
                <h2 id="audit-trails">Audit Trails<a class="headerlink" href="#audit-trails" title="Permanent link">&para;</a></h2>
<p>FlowKit supports structured logging in JSON form for all interactions with FlowAPI, primarily to facilitate audit trails.</p>
<p>Three kinds of access log are written on each request handled by FlowAPI: authentication, data access at API side, and data access on the FlowMachine side.</p>
<h3 id="authentication-logs">Authentication Logs<a class="headerlink" href="#authentication-logs" title="Permanent link">&para;</a></h3>
<p>FlowAPI logs all access attempts whether successful or not to stdout, and to a rotating log file. By default, this will be written at <code>/var/log/flowapi/flowkit-access.log</code>. The directory the log files are written to can be changed by setting the <code>LOG_DIRECTORY</code> environment variable.</p>
<p>Where authentication succeeds, the log message will have a <code>level</code> field of <code>info</code>, and an <code>event</code> type of <code>AUTHENTICATED</code>:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;fe1d5dd2-ddfb-4b34-9d1e-4ebfc205d64c&quot;</span><span class="p">,</span>
    <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/0/run&quot;</span><span class="p">,</span>
    <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;TEST_USER&quot;</span><span class="p">,</span>
    <span class="nt">&quot;src_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;json_payload&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-01-01&quot;</span><span class="p">,</span>
            <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;admin3&quot;</span><span class="p">,</span>
            <span class="nt">&quot;daily_location_method&quot;</span><span class="p">:</span> <span class="s2">&quot;last&quot;</span><span class="p">,</span>
            <span class="nt">&quot;aggregation_unit&quot;</span><span class="p">:</span> <span class="s2">&quot;admin3&quot;</span><span class="p">,</span>
            <span class="nt">&quot;subscriber_subset&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;query_kind&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_location&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;AUTHENTICATED&quot;</span><span class="p">,</span>
    <span class="nt">&quot;logger&quot;</span><span class="p">:</span> <span class="s2">&quot;flowkit-access&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-10T13:57:35.262214Z&quot;</span>
<span class="p">}</span>
</pre></div>

<p>In general, access log messages contain at a minimum the route that access was requested to, any json payload, source IP address for the request, and a timestamp. Every request <em>also</em> has a <em>unique id</em>, which will be the same across all log entries related to that request.</p>
<p>If authentication fails, then the reason is also included in the log message, along with any error message and as much information about the request and requester as can be discerned.</p>
<h3 id="api-usage-logs">API Usage Logs<a class="headerlink" href="#api-usage-logs" title="Permanent link">&para;</a></h3>
<p>After a request is successfully authenticated (has a valid token), the <em>nature</em> of the request will be logged at several points. When the request is received, if at any point the request is rejected because the provided token did not grant access, and when the request is fulfilled.</p>
<p>As with the authentication log, the usage log is written to both stdout and a rotating log file. Logs will be written to <code>query-runs.log</code> in the same directory as the authentication log.</p>
<h3 id="flowmachine-usage-logs">FlowMachine Usage Logs<a class="headerlink" href="#flowmachine-usage-logs" title="Permanent link">&para;</a></h3>
<p>If a request has triggered an action in the FlowMachine backend, logs will also be written there. These logs will include the <code>request_id</code> for the API request which originally triggered them.</p>
<p>As with the FlowAPI loggers, these messages are written both to stdout and a rotating log file (<code>/var/log/flowmachine-server/query-runs.log</code>, although the directory can be set using the <code>LOG_DIRECTORY</code> environment variable.)</p>
<h3 id="complete-logging-cycle">Complete Logging Cycle<a class="headerlink" href="#complete-logging-cycle" title="Permanent link">&para;</a></h3>
<p>A complete logging cycle for a successful request to retrieve a previously run query's results might look like this:</p>
<p>FlowAPI access log:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d2892489-8fb8-40ec-94e6-2467266a0226&quot;</span><span class="p">,</span>
    <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/0/get/ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;TEST_USER&quot;</span><span class="p">,</span>
    <span class="nt">&quot;src_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;json_payload&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;AUTHENTICATED&quot;</span><span class="p">,</span>
    <span class="nt">&quot;logger&quot;</span><span class="p">:</span> <span class="s2">&quot;flowkit-access&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-10T14:11:03.331967Z&quot;</span>
<span class="p">}</span>
</pre></div>

<p>FlowAPI usage log:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d2892489-8fb8-40ec-94e6-2467266a0226&quot;</span><span class="p">,</span>
    <span class="nt">&quot;query_kind&quot;</span><span class="p">:</span> <span class="s2">&quot;DAILY_LOCATION&quot;</span><span class="p">,</span>
    <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/0/get/ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;TEST_USER&quot;</span><span class="p">,</span>
    <span class="nt">&quot;src_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;json_payload&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;claims&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;get_result&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">&quot;poll&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">&quot;run&quot;</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
        <span class="nt">&quot;spatial_aggregation&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;admin2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;admin0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;admin3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;admin1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cell&quot;</span><span class="p">,</span>
            <span class="s2">&quot;site&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;Received&quot;</span><span class="p">,</span>
    <span class="nt">&quot;logger&quot;</span><span class="p">:</span> <span class="s2">&quot;flowkit-query&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-10T14:11:03.337052Z&quot;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d2892489-8fb8-40ec-94e6-2467266a0226&quot;</span><span class="p">,</span>
    <span class="nt">&quot;query_kind&quot;</span><span class="p">:</span> <span class="s2">&quot;DAILY_LOCATION&quot;</span><span class="p">,</span>
    <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;/api/0/get/ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;TEST_USER&quot;</span><span class="p">,</span>
    <span class="nt">&quot;src_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;json_payload&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;claims&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;get_result&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">&quot;poll&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">&quot;run&quot;</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
        <span class="nt">&quot;spatial_aggregation&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;admin2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;admin0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;admin3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;admin1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cell&quot;</span><span class="p">,</span>
            <span class="s2">&quot;site&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;Authorised&quot;</span><span class="p">,</span>
    <span class="nt">&quot;logger&quot;</span><span class="p">:</span> <span class="s2">&quot;flowkit-query&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-10T14:11:03.341010Z&quot;</span>
<span class="p">}</span>
</pre></div>

<p>FlowMachine usage log:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;query_kind&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_location&quot;</span><span class="p">,</span>
    <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;b&#39;{\&quot;request_id\&quot;:\&quot;d2892489-8fb8-40ec-94e6-2467266a0226\&quot;,\&quot;action\&quot;:\&quot;get_query_kind\&quot;,\&quot;query_id\&quot;:\&quot;ddc61a04f608dee16fff0655f91c2057\&quot;}&#39;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d2892489-8fb8-40ec-94e6-2467266a0226&quot;</span><span class="p">,</span>
    <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span> <span class="p">},</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;get_query_kind&quot;</span><span class="p">,</span>
    <span class="nt">&quot;logger&quot;</span><span class="p">:</span> <span class="s2">&quot;flowmachine-server&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-10T14:11:03.335437Z&quot;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;retrieved_params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;aggregation_unit&quot;</span><span class="p">:</span> <span class="s2">&quot;admin3&quot;</span><span class="p">,</span>
        <span class="nt">&quot;daily_location_method&quot;</span><span class="p">:</span> <span class="s2">&quot;last&quot;</span><span class="p">,</span>
        <span class="nt">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-01-01&quot;</span><span class="p">,</span>
        <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;admin3&quot;</span><span class="p">,</span>
        <span class="nt">&quot;subscriber_subset&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;b&#39;{\&quot;request_id\&quot;:\&quot;d2892489-8fb8-40ec-94e6-2467266a0226\&quot;,\&quot;action\&quot;:\&quot;get_params\&quot;,\&quot;query_id\&quot;:\&quot;ddc61a04f608dee16fff0655f91c2057\&quot;}&#39;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d2892489-8fb8-40ec-94e6-2467266a0226&quot;</span><span class="p">,</span>
    <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span> <span class="p">},</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;get_params&quot;</span><span class="p">,</span>
    <span class="nt">&quot;logger&quot;</span><span class="p">:</span> <span class="s2">&quot;flowmachine-server&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-10T14:11:03.339602Z&quot;</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span><span class="p">,</span>
    <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;b&#39;{\&quot;request_id\&quot;:\&quot;d2892489-8fb8-40ec-94e6-2467266a0226\&quot;,\&quot;action\&quot;:\&quot;get_sql\&quot;,\&quot;query_id\&quot;:\&quot;ddc61a04f608dee16fff0655f91c2057\&quot;}&#39;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d2892489-8fb8-40ec-94e6-2467266a0226&quot;</span><span class="p">,</span>
    <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;query_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ddc61a04f608dee16fff0655f91c2057&quot;</span> <span class="p">},</span>
    <span class="nt">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;get_sql&quot;</span><span class="p">,</span>
    <span class="nt">&quot;logger&quot;</span><span class="p">:</span> <span class="s2">&quot;flowmachine-server&quot;</span><span class="p">,</span>
    <span class="nt">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-10T14:11:03.358644Z&quot;</span>
<span class="p">}</span>
</pre></div>

<p>Note that the <code>request_id</code> field is identical across the five log entries, which lets you match the request across the multiple services.</p>
<h3 id="managing-and-monitoring-logs">Managing and Monitoring Logs<a class="headerlink" href="#managing-and-monitoring-logs" title="Permanent link">&para;</a></h3>
<p>Because FlowKit employs structured logging, and all log messages are JSON objects, the access and usage logs are easy to use with tools like <a href="https://www.elastic.co/products/logstash">Logstash</a>. Getting FlowKit logs into Logstash is as easy as configuring it to consume the log files generated.</p>
<p>Once approach to this is to mount the volumes for <code>/var/log/flowmachine-server/</code> and <code>/var/log/flowapi/</code> and expose the log files to Logstash, or a log shipper.</p>
<p>Alternatively, <a href="https://www.elastic.co/docker-kubernetes-container-monitoring">Filebeat</a> allows you to integrate the logs from stdout directly into your monitoring system.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/Flowminder" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/Flowminder" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
      
    
    
      
    
  </body>
</html>