<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.0"><title>Installation</title><link rel="stylesheet" href="../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content=""><script src="../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../assets/fonts/material-icons.css"><link rel="stylesheet" href="../stylesheets/extra.css"><link rel="stylesheet" href="https://unpkg.com/mermaid@7.1.2/dist/mermaid.css"></head><body dir="ltr" data-md-color-primary="#095798" data-md-color-accent="#2977b8"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#how-to-install-flowkit" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href=".." title="FlowKit" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">FlowKit</span><span class="md-header-nav__topic">Installation</span></div></div><div class="md-flex__cell md-flex__cell--shrink"></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/Flowminder/FlowKit" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">Flowminder/FlowKit</div></a></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href=".." title="FlowKit" class="md-nav__button md-logo"><i class="md-icon"></i></a>FlowKit</label><div class="md-nav__source"><a href="https://github.com/Flowminder/FlowKit" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">Flowminder/FlowKit</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href=".." title="Introduction" class="md-nav__link">Introduction</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Installation</label><a href="./" title="Installation" class="md-nav__link md-nav__link--active">Installation</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#installation-requirements" title="Installation Requirements" class="md-nav__link">Installation Requirements</a></li><li class="md-nav__item"><a href="#quick-install" title="Quick Install" class="md-nav__link">Quick Install</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#flowauth-quickstart" title="FlowAuth Quickstart" class="md-nav__link">FlowAuth Quickstart</a></li><li class="md-nav__item"><a href="#flowclient" title="FlowClient  " class="md-nav__link">FlowClient  </a></li></ul></nav></li><li class="md-nav__item"><a href="#developer-install" title="Developer Install" class="md-nav__link">Developer Install</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#installation-requirements-for-developers" title="Installation Requirements for Developers" class="md-nav__link">Installation Requirements for Developers</a></li><li class="md-nav__item"><a href="#setting-up-flowkit-for-development" title="Setting up FlowKit for development" class="md-nav__link">Setting up FlowKit for development</a></li></ul></nav></li><li class="md-nav__item"><a href="#production-install" title="Production Install" class="md-nav__link">Production Install</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#flowauth-production-deployment" title="FlowAuth Production Deployment" class="md-nav__link">FlowAuth Production Deployment</a></li><li class="md-nav__item"><a href="#running-with-secrets" title="Running with Secrets" class="md-nav__link">Running with Secrets</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#secrets-quickstart" title="Secrets Quickstart" class="md-nav__link">Secrets Quickstart</a></li></ul></nav></li><li class="md-nav__item"><a href="#demonstrating-successful-deployment" title="Demonstrating successful deployment" class="md-nav__link">Demonstrating successful deployment</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="../analyst/" title="Analyst" class="md-nav__link">Analyst</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"><label class="md-nav__link" for="nav-4">Developer</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Developer</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../developer/developer/" title="Information for Developers" class="md-nav__link">Information for Developers</a></li><li class="md-nav__item"><a href="../developer/dev_environment_setup/" title="Setting up a development environment" class="md-nav__link">Setting up a development environment</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3"><label class="md-nav__link" for="nav-4-3">Architectural Decision Records (ADR)</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-3">Architectural Decision Records (ADR)</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../developer/adr/" title="Architectural Decision Records" class="md-nav__link">Architectural Decision Records</a></li><li class="md-nav__item"><a href="../developer/adr/0001-pipenv-for-package-and-dependency-management/" title="Pipenv for package / dependency management and virtual environments" class="md-nav__link">Pipenv for package / dependency management and virtual environments</a></li><li class="md-nav__item"><a href="../developer/adr/0002-pytest-for-testing/" title="Pytest for testing Flowkit components" class="md-nav__link">Pytest for testing Flowkit components</a></li><li class="md-nav__item"><a href="../developer/adr/0003-http-api/" title="HTTP API as Single Access Point" class="md-nav__link">HTTP API as Single Access Point</a></li><li class="md-nav__item"><a href="../developer/adr/0004-http-framework/" title="Quart as HTTP Framework" class="md-nav__link">Quart as HTTP Framework</a></li><li class="md-nav__item"><a href="../developer/adr/0005-IPC-methods/" title="Interprocess Communication (IPC) Methods - zeromq and redis" class="md-nav__link">Interprocess Communication (IPC) Methods - zeromq and redis</a></li><li class="md-nav__item"><a href="../developer/adr/0006-JWTs/" title="JWTs for API Access Control" class="md-nav__link">JWTs for API Access Control</a></li><li class="md-nav__item"><a href="../developer/adr/0007-mapbox-for-worked-examples/" title="Mapbox GL for map visualisations in the worked examples notebooks" class="md-nav__link">Mapbox GL for map visualisations in the worked examples notebooks</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="../administrator/" title="Administrator" class="md-nav__link">Administrator</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"><label class="md-nav__link" for="nav-6">Worked examples</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">Worked examples</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../worked_examples/" title="Worked examples" class="md-nav__link">Worked examples</a></li><li class="md-nav__item"><a href="../worked_examples/flows-above-normal/" title="Flows Above Normal" class="md-nav__link">Flows Above Normal</a></li><li class="md-nav__item"><a href="../worked_examples/commuting-patterns/" title="Commuting Patterns" class="md-nav__link">Commuting Patterns</a></li><li class="md-nav__item"><a href="../worked_examples/cell-towers-per-region/" title="Cell Towers Per Region" class="md-nav__link">Cell Towers Per Region</a></li><li class="md-nav__item"><a href="../worked_examples/unique-subscriber-counts/" title="Unique Subscriber Counts" class="md-nav__link">Unique Subscriber Counts</a></li><li class="md-nav__item"><a href="../worked_examples/mobile-data-usage/" title="Mobile Data Usage" class="md-nav__link">Mobile Data Usage</a></li></ul></nav></li><li class="md-nav__item"><a href="../api-spec.html" title="FlowAPI specification" class="md-nav__link">FlowAPI specification</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8"><label class="md-nav__link" for="nav-8">Flowmachine</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-8">Flowmachine</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1"><label class="md-nav__link" for="nav-8-1">Flowmachine</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-8-1">Flowmachine</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/" title="flowmachine" class="md-nav__link">flowmachine</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-2" type="checkbox" id="nav-8-1-2"><label class="md-nav__link" for="nav-8-1-2">Core</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-8-1-2">Core</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/" title="core" class="md-nav__link">core</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/cache/" title="cache" class="md-nav__link">cache</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/connection/" title="connection" class="md-nav__link">connection</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/custom_query/" title="custom_query" class="md-nav__link">custom_query</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/date_range/" title="date_range" class="md-nav__link">date_range</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/dummy_query/" title="dummy_query" class="md-nav__link">dummy_query</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-2-7" type="checkbox" id="nav-8-1-2-7"><label class="md-nav__link" for="nav-8-1-2-7">Errors</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-2-7">Errors</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/errors/" title="errors" class="md-nav__link">errors</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/errors/flowmachine_errors/" title="flowmachine_errors" class="md-nav__link">flowmachine_errors</a></li></ul></nav></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/geotable/" title="geotable" class="md-nav__link">geotable</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/hour_slice/" title="hour_slice" class="md-nav__link">hour_slice</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/init/" title="init" class="md-nav__link">init</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/join/" title="join" class="md-nav__link">join</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/join_to_location/" title="join_to_location" class="md-nav__link">join_to_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/logging/" title="logging" class="md-nav__link">logging</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-2-14" type="checkbox" id="nav-8-1-2-14"><label class="md-nav__link" for="nav-8-1-2-14">Mixins</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-2-14">Mixins</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/mixins/" title="mixins" class="md-nav__link">mixins</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/mixins/geodata_mixin/" title="geodata_mixin" class="md-nav__link">geodata_mixin</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/mixins/graph_mixin/" title="graph_mixin" class="md-nav__link">graph_mixin</a></li></ul></nav></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/model/" title="model" class="md-nav__link">model</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/model_result/" title="model_result" class="md-nav__link">model_result</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/query/" title="query" class="md-nav__link">query</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/query_info_lookup/" title="query_info_lookup" class="md-nav__link">query_info_lookup</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/query_state/" title="query_state" class="md-nav__link">query_state</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/random/" title="random" class="md-nav__link">random</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-2-21" type="checkbox" id="nav-8-1-2-21"><label class="md-nav__link" for="nav-8-1-2-21">Server</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-2-21">Server</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/" title="server" class="md-nav__link">server</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/action_handlers/" title="action_handlers" class="md-nav__link">action_handlers</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/action_request_schema/" title="action_request_schema" class="md-nav__link">action_request_schema</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/exceptions/" title="exceptions" class="md-nav__link">exceptions</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-2-21-5" type="checkbox" id="nav-8-1-2-21-5"><label class="md-nav__link" for="nav-8-1-2-21-5">Query schemas</label><nav class="md-nav" data-md-component="collapsible" data-md-level="5"><label class="md-nav__title" for="nav-8-1-2-21-5">Query schemas</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/" title="query_schemas" class="md-nav__link">query_schemas</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/aggregate_network_objects/" title="aggregate_network_objects" class="md-nav__link">aggregate_network_objects</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/base_exposed_query/" title="base_exposed_query" class="md-nav__link">base_exposed_query</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/custom_fields/" title="custom_fields" class="md-nav__link">custom_fields</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/daily_location/" title="daily_location" class="md-nav__link">daily_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/dfs_metric_total_amount/" title="dfs_metric_total_amount" class="md-nav__link">dfs_metric_total_amount</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/dummy_query/" title="dummy_query" class="md-nav__link">dummy_query</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/flowmachine_query/" title="flowmachine_query" class="md-nav__link">flowmachine_query</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/flows/" title="flows" class="md-nav__link">flows</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/geography/" title="geography" class="md-nav__link">geography</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/joined_spatial_aggregate/" title="joined_spatial_aggregate" class="md-nav__link">joined_spatial_aggregate</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/location_event_counts/" title="location_event_counts" class="md-nav__link">location_event_counts</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/location_introversion/" title="location_introversion" class="md-nav__link">location_introversion</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/meaningful_locations/" title="meaningful_locations" class="md-nav__link">meaningful_locations</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/modal_location/" title="modal_location" class="md-nav__link">modal_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/radius_of_gyration/" title="radius_of_gyration" class="md-nav__link">radius_of_gyration</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/spatial_aggregate/" title="spatial_aggregate" class="md-nav__link">spatial_aggregate</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/total_network_objects/" title="total_network_objects" class="md-nav__link">total_network_objects</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/query_schemas/unique_subscriber_counts/" title="unique_subscriber_counts" class="md-nav__link">unique_subscriber_counts</a></li></ul></nav></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/server/" title="server" class="md-nav__link">server</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/utils/" title="utils" class="md-nav__link">utils</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/server/zmq_helpers/" title="zmq_helpers" class="md-nav__link">zmq_helpers</a></li></ul></nav></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/sqlalchemy_table_definitions/" title="sqlalchemy_table_definitions" class="md-nav__link">sqlalchemy_table_definitions</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/sqlalchemy_utils/" title="sqlalchemy_utils" class="md-nav__link">sqlalchemy_utils</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/subscriber_subsetter/" title="subscriber_subsetter" class="md-nav__link">subscriber_subsetter</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/subset/" title="subset" class="md-nav__link">subset</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/table/" title="table" class="md-nav__link">table</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/core/union/" title="union" class="md-nav__link">union</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3" type="checkbox" id="nav-8-1-3"><label class="md-nav__link" for="nav-8-1-3">Features</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-8-1-3">Features</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/" title="features" class="md-nav__link">features</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3-2" type="checkbox" id="nav-8-1-3-2"><label class="md-nav__link" for="nav-8-1-3-2">Dfs</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-3-2">Dfs</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/dfs/" title="dfs" class="md-nav__link">dfs</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/dfs/total_amount_for_metric/" title="total_amount_for_metric" class="md-nav__link">total_amount_for_metric</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3-3" type="checkbox" id="nav-8-1-3-3"><label class="md-nav__link" for="nav-8-1-3-3">Location</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-3-3">Location</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/location/" title="location" class="md-nav__link">location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/location/flows/" title="flows" class="md-nav__link">flows</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/location/location_introversion/" title="location_introversion" class="md-nav__link">location_introversion</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/location/total_events/" title="total_events" class="md-nav__link">total_events</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/location/unique_subscriber_counts/" title="unique_subscriber_counts" class="md-nav__link">unique_subscriber_counts</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3-4" type="checkbox" id="nav-8-1-3-4"><label class="md-nav__link" for="nav-8-1-3-4">Network</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-3-4">Network</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/network/" title="network" class="md-nav__link">network</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/network/total_network_objects/" title="total_network_objects" class="md-nav__link">total_network_objects</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3-5" type="checkbox" id="nav-8-1-3-5"><label class="md-nav__link" for="nav-8-1-3-5">Raster</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-3-5">Raster</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/raster/" title="raster" class="md-nav__link">raster</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/raster/raster_statistics/" title="raster_statistics" class="md-nav__link">raster_statistics</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3-6" type="checkbox" id="nav-8-1-3-6"><label class="md-nav__link" for="nav-8-1-3-6">Spatial</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-3-6">Spatial</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/" title="spatial" class="md-nav__link">spatial</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/cell_mappings/" title="cell_mappings" class="md-nav__link">cell_mappings</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/circles/" title="circles" class="md-nav__link">circles</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/distance_matrix/" title="distance_matrix" class="md-nav__link">distance_matrix</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/grid/" title="grid" class="md-nav__link">grid</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/location_area/" title="location_area" class="md-nav__link">location_area</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/location_cluster/" title="location_cluster" class="md-nav__link">location_cluster</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/spatial/versioned_infrastructure/" title="versioned_infrastructure" class="md-nav__link">versioned_infrastructure</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3-7" type="checkbox" id="nav-8-1-3-7"><label class="md-nav__link" for="nav-8-1-3-7">Subscriber</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-3-7">Subscriber</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/" title="subscriber" class="md-nav__link">subscriber</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/call_days/" title="call_days" class="md-nav__link">call_days</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/contact_balance/" title="contact_balance" class="md-nav__link">contact_balance</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/contact_reciprocal/" title="contact_reciprocal" class="md-nav__link">contact_reciprocal</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/contact_reference_locations_stats/" title="contact_reference_locations_stats" class="md-nav__link">contact_reference_locations_stats</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/daily_location/" title="daily_location" class="md-nav__link">daily_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/day_trajectories/" title="day_trajectories" class="md-nav__link">day_trajectories</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/displacement/" title="displacement" class="md-nav__link">displacement</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/distance_counterparts/" title="distance_counterparts" class="md-nav__link">distance_counterparts</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/entropy/" title="entropy" class="md-nav__link">entropy</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/event_count/" title="event_count" class="md-nav__link">event_count</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/event_type_proportion/" title="event_type_proportion" class="md-nav__link">event_type_proportion</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/first_location/" title="first_location" class="md-nav__link">first_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/handset_stats/" title="handset_stats" class="md-nav__link">handset_stats</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/interevent_period/" title="interevent_period" class="md-nav__link">interevent_period</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/label_event_score/" title="label_event_score" class="md-nav__link">label_event_score</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/last_location/" title="last_location" class="md-nav__link">last_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/location_visits/" title="location_visits" class="md-nav__link">location_visits</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/mds_volume/" title="mds_volume" class="md-nav__link">mds_volume</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/meaningful_locations/" title="meaningful_locations" class="md-nav__link">meaningful_locations</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/metaclasses/" title="metaclasses" class="md-nav__link">metaclasses</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/modal_location/" title="modal_location" class="md-nav__link">modal_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/most_frequent_location/" title="most_frequent_location" class="md-nav__link">most_frequent_location</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/new_subscribers/" title="new_subscribers" class="md-nav__link">new_subscribers</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/nocturnal_events/" title="nocturnal_events" class="md-nav__link">nocturnal_events</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/pareto_interactions/" title="pareto_interactions" class="md-nav__link">pareto_interactions</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/per_contact_event_stats/" title="per_contact_event_stats" class="md-nav__link">per_contact_event_stats</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/per_location_event_stats/" title="per_location_event_stats" class="md-nav__link">per_location_event_stats</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/radius_of_gyration/" title="radius_of_gyration" class="md-nav__link">radius_of_gyration</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/scores/" title="scores" class="md-nav__link">scores</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/subscriber_call_durations/" title="subscriber_call_durations" class="md-nav__link">subscriber_call_durations</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/subscriber_degree/" title="subscriber_degree" class="md-nav__link">subscriber_degree</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/subscriber_location_cluster/" title="subscriber_location_cluster" class="md-nav__link">subscriber_location_cluster</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/subscriber_tacs/" title="subscriber_tacs" class="md-nav__link">subscriber_tacs</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/topup_amount/" title="topup_amount" class="md-nav__link">topup_amount</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/topup_balance/" title="topup_balance" class="md-nav__link">topup_balance</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/total_active_periods/" title="total_active_periods" class="md-nav__link">total_active_periods</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/subscriber/unique_location_counts/" title="unique_location_counts" class="md-nav__link">unique_location_counts</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-3-8" type="checkbox" id="nav-8-1-3-8"><label class="md-nav__link" for="nav-8-1-3-8">Utilities</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-8-1-3-8">Utilities</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/" title="utilities" class="md-nav__link">utilities</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/event_table_subset/" title="event_table_subset" class="md-nav__link">event_table_subset</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/events_tables_union/" title="events_tables_union" class="md-nav__link">events_tables_union</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/feature_collection/" title="feature_collection" class="md-nav__link">feature_collection</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/group_values/" title="group_values" class="md-nav__link">group_values</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/multilocation/" title="multilocation" class="md-nav__link">multilocation</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/sets/" title="sets" class="md-nav__link">sets</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/spatial_aggregates/" title="spatial_aggregates" class="md-nav__link">spatial_aggregates</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/features/utilities/subscriber_locations/" title="subscriber_locations" class="md-nav__link">subscriber_locations</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1-4" type="checkbox" id="nav-8-1-4"><label class="md-nav__link" for="nav-8-1-4">Models</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-8-1-4">Models</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowmachine/flowmachine/models/" title="models" class="md-nav__link">models</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/models/louvain/" title="louvain" class="md-nav__link">louvain</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/models/pwo/" title="pwo" class="md-nav__link">pwo</a></li></ul></nav></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/utils/" title="utils" class="md-nav__link">utils</a></li><li class="md-nav__item"><a href="../flowmachine/flowmachine/versions/" title="versions" class="md-nav__link">versions</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"><label class="md-nav__link" for="nav-9">FlowClient</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-9">FlowClient</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowclient/example_usage/" title="Example usage" class="md-nav__link">Example usage</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2"><label class="md-nav__link" for="nav-9-2">Flowclient</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-9-2">Flowclient</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-1" type="checkbox" id="nav-9-2-1"><label class="md-nav__link" for="nav-9-2-1">Flowclient</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-9-2-1">Flowclient</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../flowclient/flowclient/" title="flowclient" class="md-nav__link">flowclient</a></li><li class="md-nav__item"><a href="../flowclient/flowclient/client/" title="client" class="md-nav__link">client</a></li></ul></nav></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="../license/" title="License" class="md-nav__link">License</a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#installation-requirements" title="Installation Requirements" class="md-nav__link">Installation Requirements</a></li><li class="md-nav__item"><a href="#quick-install" title="Quick Install" class="md-nav__link">Quick Install</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#flowauth-quickstart" title="FlowAuth Quickstart" class="md-nav__link">FlowAuth Quickstart</a></li><li class="md-nav__item"><a href="#flowclient" title="FlowClient  " class="md-nav__link">FlowClient  </a></li></ul></nav></li><li class="md-nav__item"><a href="#developer-install" title="Developer Install" class="md-nav__link">Developer Install</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#installation-requirements-for-developers" title="Installation Requirements for Developers" class="md-nav__link">Installation Requirements for Developers</a></li><li class="md-nav__item"><a href="#setting-up-flowkit-for-development" title="Setting up FlowKit for development" class="md-nav__link">Setting up FlowKit for development</a></li></ul></nav></li><li class="md-nav__item"><a href="#production-install" title="Production Install" class="md-nav__link">Production Install</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#flowauth-production-deployment" title="FlowAuth Production Deployment" class="md-nav__link">FlowAuth Production Deployment</a></li><li class="md-nav__item"><a href="#running-with-secrets" title="Running with Secrets" class="md-nav__link">Running with Secrets</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#secrets-quickstart" title="Secrets Quickstart" class="md-nav__link">Secrets Quickstart</a></li></ul></nav></li><li class="md-nav__item"><a href="#demonstrating-successful-deployment" title="Demonstrating successful deployment" class="md-nav__link">Demonstrating successful deployment</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><h1 id="how-to-install-flowkit">How to Install FlowKit<a class="headerlink" href="#how-to-install-flowkit" title="Permanent link">&para;</a></h1>
<p>There are three main ways to install FlowKit.</p>
<ul>
<li><a href="#quickinstall">Quick Install</a>; suitable for a try-out on a local PC, includes basic example using FlowClient.</li>
<li><a href="#developers">Developer Install</a>; for those wishing to contribute code</li>
<li><a href="#prodinstall">Production Install</a>; for deployment, e.g. inside an MNO firewall</li>
</ul>
<p><a name="installationrequirements"></p>
<h2 id="installation-requirements">Installation Requirements<a class="headerlink" href="#installation-requirements" title="Permanent link">&para;</a></h2>
<p>Most FlowKit components (FlowDB, FlowMachine, FlowAPI, FlowAuth) are distributed as docker containers. To install these, you need:
- <code>docker &gt;= 17.12.0</code>
- <code>docker-compose &gt;= 1.21.0</code></p>
<p>In addition, running FlowClient requires:
- <code>Python &gt;= 3.6</code></p>
<p>There are additional requirements for a development setup. See the <a href="#developers">Developer install</a> section below for details.</p>
<p><a name="quickinstall"></p>
<h2 id="quick-install">Quick Install<a class="headerlink" href="#quick-install" title="Permanent link">&para;</a></h2>
<p>This quick install guide will install the major components of FlowKit together with an intial setup and example analysis query.</p>
<p>The bulk of the installation process consists of using <a href="https://docs.docker.com/compose/">Docker Compose</a> to download <a href="https://docs.docker.com/install/">Docker</a> containers from <a href="https://hub.docker.com/u/flowminder">Docker Hub</a>, followed by a <code>pip install</code> of FlowClient.</p>
<p>These instructions assume use of <a href="https://github.com/pyenv/pyenv">Pyenv</a> and <a href="https://github.com/pypa/pipenv">Pipenv</a>. If you are using <a href="https://www.anaconda.com/what-is-anaconda/">Anaconda</a>-based installation commands may be different.</p>
<p>Docker containers for FlowAPI, FlowMachine, FlowDB, FlowAuth and the worked examples are provided in the Docker Hub repositories <a href="https://hub.docker.com/r/flowminder/flowapi">flowminder/flowapi</a>, <a href="https://hub.docker.com/r/flowminder/flowmachine">flowminder/flowmachine</a>, <a href="https://hub.docker.com/r/flowminder/flowdb">flowminder/flowdb</a>, <a href="https://hub.docker.com/r/flowminder/flowauth">flowminder/flowauth</a>, and <a href="https://hub.docker.com/r/flowminder/flowkit-examples">flowminder/flowkit-examples</a> respectively. To install them, you will need <a href="https://docs.docker.com/install/">Docker</a> and <a href="https://docs.docker.com/compose/install/">Docker Compose</a>.</p>
<p>Start the FlowKit test system by running </p>
<div class="codehilite"><pre><span></span>bash &lt;<span class="o">(</span>curl -s https://raw.githubusercontent.com/Flowminder/FlowKit/master/quick_start.sh<span class="o">)</span>
</pre></div>

<p>This will pull any necessary docker containers, and start the system in the background with the API exposed on port <code>9090</code> by default, and the FlowAuth authentication system accessible by visiting <a href="http://localhost:9091/" target="_blank"><a href="http://localhost:9091">http://localhost:9091</a></a> using your web browser.</p>
<p>The default system includes a small amount of test data. For a test system with considerably more data you can run</p>
<div class="codehilite"><pre><span></span>bash &lt;<span class="o">(</span>curl -s https://raw.githubusercontent.com/Flowminder/FlowKit/master/quick_start.sh<span class="o">)</span> larger_data
</pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The larger data container will take considerably longer to start up, as it generates data when first run.</p>
</div>
<p>The <a href="../worked_examples/">worked examples</a> are also available as part of the demo system. To install these run </p>
<div class="codehilite"><pre><span></span>bash &lt;<span class="o">(</span>curl -s https://raw.githubusercontent.com/Flowminder/FlowKit/master/quick_start.sh<span class="o">)</span> examples smaller_data
</pre></div>

<p>for the examples with a small dataset, or </p>
<div class="codehilite"><pre><span></span>bash &lt;<span class="o">(</span>curl -s https://raw.githubusercontent.com/Flowminder/FlowKit/master/quick_start.sh<span class="o">)</span> examples
</pre></div>

<p>to get the examples with the larger dataset (the one used when producing this documentation).</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The small dataset is sufficient for most of the worked examples, but the larger dataset is required for the <a href="../worked_examples/flows-above-normal/">Flows Above Normal</a> example because this uses data for dates outside the range included in the small dataset.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The worked examples make use of <a href="https://mapbox-mapboxgl-jupyter.readthedocs-hosted.com/en/latest/">Mapbox GL</a> for visualisation, which requires an API access token. If you would like to produce the maps in the worked examples notebooks, you will need to create a mapbox access token (following instructions <a href="https://account.mapbox.com/">here</a>), and set this as the value of the <code>MAPBOX_ACCESS_TOKEN</code> environment variable before running the above commands.</p>
</div>
<p>To shut down the system, you can either stop all the docker containers directly, or run</p>
<div class="codehilite"><pre><span></span>bash &lt;<span class="o">(</span>curl -s https://raw.githubusercontent.com/Flowminder/FlowKit/master/quick_start.sh<span class="o">)</span> stop
</pre></div>

<p>In order to use the test system, now <a href="#flowclient">install FlowClient</a>, and generate a token using FlowAuth.</p>
<h3 id="flowauth-quickstart">FlowAuth Quickstart<a class="headerlink" href="#flowauth-quickstart" title="Permanent link">&para;</a></h3>
<p>Visit <a href="http://localhost:9091/" target="_blank"><a href="http://localhost:9091">http://localhost:9091</a></a> and log in with either <code>TEST_ADMIN:DUMMY_PASSWORD</code> or <code>TEST_USER:DUMMY_PASSWORD</code>. <code>TEST_USER</code> is already set up to generate tokens for the FlowAPI instance started by the quick start script.</p>
<p>See the <a href="../administrator/#granting-user-permissions-in-flowauth">administrator section</a> for details of how to add servers and users or modify user permissions, or the <a href="../analyst/#flowauth">analyst section</a> for instructions to generate a token.</p>
<h3 id="flowclient">FlowClient <a name="flowclient"> </a><a class="headerlink" href="#flowclient" title="Permanent link">&para;</a></h3>
<p>The FlowClient Python client is used to perform CDR analysis using the JupyterLab Python Data Science Stack. It may be installed using pip:</p>
<div class="codehilite"><pre><span></span>pip install flowclient
</pre></div>

<p>Quick install is continued with an example of FlowClient usage <a href="../analyst/#flowclient">here</a>.</p>
<p><a name="developers"></p>
<h2 id="developer-install">Developer Install</a><a class="headerlink" href="#developer-install" title="Permanent link">&para;</a></h2>
<h3 id="installation-requirements-for-developers">Installation Requirements for Developers<a class="headerlink" href="#installation-requirements-for-developers" title="Permanent link">&para;</a></h3>
<p>Just as for a regular installation, you will need <code>docker</code> and <code>docker-compose</code> (see <a href="#installationrequirements">Installation requirements</a> above).</p>
<p>During development, you will typically also want to run FlowMachine, FlowAPI and FlowAuth outside docker containers. This requires additional prerequisites to be available.</p>
<ul>
<li><a href="https://pipenv.readthedocs.io/en/latest/">Pipenv</a> (to manage separate pipenv environment for each FlowKit component)</li>
<li>FlowMachine server: <code>Python &gt;= 3.7</code></li>
<li>FlowAuth: <code>npm</code> (we recommend installing it via <a href="https://github.com/nvm-sh/nvm">nvm</a>); <a href="https://www.cypress.io/">Cypress</a> for testing</li>
</ul>
<h3 id="setting-up-flowkit-for-development">Setting up FlowKit for development<a class="headerlink" href="#setting-up-flowkit-for-development" title="Permanent link">&para;</a></h3>
<p>After cloning the <a href="https://github.com/Flowminder/FlowKit">GitHub repository</a>, the FlowKit system can be started by running <code>make up</code> in the root directory. This requires Docker](<a href="https://docs.docker.com/install/">https://docs.docker.com/install/</a>) and <a href="https://docs.docker.com/compose/install/">Docker Compose</a> to be installed, and starts the flowapi, flowmachine, flowdb and redis docker containers using the <code>docker-compose.yml</code> file.</p>
<p>FlowKit uses <a href="https://pipenv.readthedocs.io/">pipenv</a> to manage Python environments. To start a Python session in which you can use FlowClient:</p>
<div class="codehilite"><pre><span></span>cd flowclient
pipenv install
pipenv run python
&gt;&gt;&gt; import flowclient
</pre></div>

<p>To run the tests in the <code>flowapi</code>, <code>flowclient</code>, <code>flowdb</code>, <code>flowmachine</code> or <code>integration_tests</code> directory:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> &lt;directory&gt;
pipenv install --dev
pipenv run pytest
</pre></div>

<p>Also see <a href="../developer/dev_environment_setup/">Setting up a development environment</a> for further details on setting up FlowKit for code development.</p>
<p><a name="prodinstall"></p>
<h2 id="production-install">Production Install<a class="headerlink" href="#production-install" title="Permanent link">&para;</a></h2>
<p>Contact Flowminder on <a href="mailto:flowkit@flowminder.org">flowkit@flowminder.org</a> for full instructions. Instructions on FlowAuth production deployment and dealing with docker secrets is described below. Note that these instructions are likely subject to change.</p>
<h3 id="flowauth-production-deployment">FlowAuth Production Deployment<a class="headerlink" href="#flowauth-production-deployment" title="Permanent link">&para;</a></h3>
<p>FlowAuth is designed to be deployed as a single Docker container working in cooperation with a database and, typically, an ssl reverse proxy (e.g. <a href="https://github.com/jwilder/nginx-proxy">nginx-proxy</a> combined with <a href="https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion">letsencrypt-nginx-proxy-companion</a>).</p>
<p>FlowAuth supports any database supported by <a href="https://sqlalche.me">SQLAlchemy</a>, and to connect you will only need to supply a correct URI for the database either using the <code>DB_URI</code> environment variable, or by setting the <code>DB_URI</code> secret. If <code>DB_URI</code> is not set, a temporary sqlite database will be created.</p>
<p>FlowAuth will attempt to create all necessary tables when first accessed, but will not overwrite any existing tables. To wipe any existing data, you can either set the <code>RESET_FLOWAUTH_DB</code> environment variable to <code>true</code>, or run <code>flask init-db</code> from inside the container (<code>docker exec &lt;container-id&gt; flask init-db</code>).</p>
<p>FlowAuth requires you to create at least one admin user by setting the <code>FLOWAUTH_ADMIN_USER</code> and <code>FLOWAUTH_ADMIN_PASSWORD</code> environment variables or providing them as secrets. You can combine these environment variables with the <code>INIT_DB</code> environment variable.</p>
<p>You <em>must</em> also provide two additional environment variables or secrets: <code>FLOWAUTH_FERNET_KEY</code>, and <code>SECRET_KEY</code>. <code>FLOWAUTH_FERNET_KEY</code> is used to encrypt server secret keys, and tokens while 'at rest' in the database, and decrypt them for use. <code>SECRET_KEY</code> is used to secure session, and CSRF protection cookies.</p>
<p>By default, <code>SECRET_KEY</code> will be set to <code>secret</code>. You should supply this to ensure a secure system.</p>
<p>While <code>SECRET_KEY</code> can be any arbitrary string, <code>FLOWAUTH_FERNET_KEY</code> should be a valid Fernet key. A convenience command is provided to generate one - <code>flask get-fernet</code>.  </p>
<h3 id="running-with-secrets">Running with Secrets<a class="headerlink" href="#running-with-secrets" title="Permanent link">&para;</a></h3>
<p>The standard Docker compose file supplies a number of 'secret' values as environment variables. Typically, this is a bad idea.</p>
<p>Instead, you should make use of <a href="https://docs.docker.com/engine/swarm/secrets/">docker secrets</a>, which are stored securely in docker and only made available <em>inside</em> containers.  The <code>secrets_quickstart</code> directory contains a docker <em>stack</em> file (<code>docker-stack.yml</code>). The stack file is very similar to a compose file, but removes container names, and adds a new section - <a href="https://docs.docker.com/compose/compose-file/#secrets-configuration-reference">secrets</a>.</p>
<p>The stack expects you to provide eight secrets:</p>
<ul>
<li>
<p>cert-flowkit.pem</p>
<p>An SSL certificate file (should contain private key as well)</p>
</li>
<li>
<p>FLOWAPI_FLOWDB_USER</p>
<p>The username the API will use to connect to FlowDB</p>
</li>
<li>
<p>FLOWAPI_FLOWDB_PASSWORD</p>
<p>The password that the API will use to connect to FlowDB</p>
</li>
<li>
<p>FLOWMACHINE_FLOWDB_USER</p>
<p>The username that FlowMachine will use to connect to FlowDB</p>
</li>
<li>
<p>FLOWMACHINE_FLOWDB_PASSWORD</p>
<p>The password that FlowMachine will use to connect to FlowDB</p>
</li>
<li>
<p>POSTGRES_PASSWORD</p>
<p>The superuser password for the <code>flowdb</code> user </p>
</li>
<li>
<p>REDIS_PASSWORD</p>
<p>The password for redis </p>
</li>
<li>
<p>JWT_SECRET_KEY</p>
<p>The secret key used to sign API access tokens</p>
</li>
<li>
<p>FLOWAPI_IDENTIFIER</p>
<p>The unique name of the FlowAPI server. Used to verify that a decoded token is intended for <em>this</em> server.</p>
</li>
</ul>
<p>To make use of secrets you will need to use docker swarm. For testing purposes, you can set up a single node swarm by running <code>docker swarm init</code>.</p>
<p>Once you have created a swarm, you can add secrets to it using the <a href="https://docs.docker.com/engine/reference/commandline/secret_create/">docker secret</a> command. For example, to add a randomly generated password for the <code>FLOWMACHINE_FLOWDB_PASSWORD</code> secret:</p>
<div class="codehilite"><pre><span></span>openssl rand -base64 <span class="m">16</span> <span class="p">|</span> docker secret create FLOWMACHINE_FLOWDB_PASSWORD -
</pre></div>

<p>And to add the (unsigned) localhost SSL certificate supplied in the <code>integration_tests</code> directory:</p>
<div class="codehilite"><pre><span></span>docker secret create cert-flowkit.pem integration_tests/cert.pem
</pre></div>

<p>(Note that unlike the other examples, we are supplying a <em>file</em> rather than piping to stdin.)</p>
<p>Once you have added all the required secrets, you can use <code>docker stack</code> to spin up FlowKit, much as you would <code>docker-compose</code>:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> secrets_quickstart
docker stack deploy --with-registry-auth -c docker-stack.yml secrets_test
</pre></div>

<p>After which, the API will be available via HTTPS (and no longer available via HTTP). Note that to access the API using FlowClient, you'll need to provide the path to the certificate as the <code>ssl_certificate</code> argument when calling <code>flowclient.Connection</code> (much as you would if using a self-signed certificate with <code>requests</code>):</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">flowclient</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">flowclient</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="s2">&quot;https://localhost:9090&quot;</span><span class="p">,</span> <span class="s2">&quot;JWT_STRING&quot;</span><span class="p">,</span> <span class="n">ssl_certificate</span><span class="o">=</span><span class="s2">&quot;/home/username/flowkit/integration_tests/client_cert.pem&quot;</span><span class="p">)</span>
</pre></div>

<h4 id="secrets-quickstart">Secrets Quickstart<a class="headerlink" href="#secrets-quickstart" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="c1"># Ensure this docker node is in swarm mode</span>
docker swarm init <span class="o">||</span> <span class="nb">true</span>

<span class="c1"># Remove existing stack deployment</span>
<span class="nb">echo</span> <span class="s2">&quot;Removing existing secrets_test_stack&quot;</span>
docker stack rm secrets_test

<span class="c1"># Wait for &#39;docker stack rm&#39; to finish (see https://github.com/moby/moby/issues/30942)</span>
<span class="nv">limit</span><span class="o">=</span><span class="m">30</span>
<span class="k">until</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="k">$(</span>docker service ls --filter <span class="nv">label</span><span class="o">=</span>com.docker.stack.namespace<span class="o">=</span>secrets_test -q<span class="k">)</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$limit</span><span class="s2">&quot;</span> -lt <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>
  sleep <span class="m">2</span>
  <span class="nv">limit</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$((</span>limit-1<span class="k">))</span><span class="s2">&quot;</span>
<span class="k">done</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$limit</span><span class="s2">&quot;</span> -lt <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Not all services in the existing docker stack have been removed.&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;Please wait (or try to remove them manually) and run this command again.&quot;</span>
<span class="k">fi</span>
<span class="nv">limit</span><span class="o">=</span><span class="m">30</span>
<span class="k">until</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="k">$(</span>docker network ls --filter <span class="nv">label</span><span class="o">=</span>com.docker.stack.namespace<span class="o">=</span>secrets_test -q<span class="k">)</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$limit</span><span class="s2">&quot;</span> -lt <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>
  sleep <span class="m">2</span>
  <span class="nv">limit</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$((</span>limit-1<span class="k">))</span><span class="s2">&quot;</span>
<span class="k">done</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$limit</span><span class="s2">&quot;</span> -lt <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Not all networks in the existing docker stack have been removed.&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;Please wait (or try to remove them manually) and run this command again.&quot;</span>
<span class="k">fi</span>

<span class="c1"># Remove existing secrets</span>
<span class="nb">echo</span> <span class="s2">&quot;Removing existing secrets&quot;</span>
docker secret rm FLOWMACHINE_FLOWDB_PASSWORD <span class="o">||</span> <span class="nb">true</span>
docker secret rm FLOWMACHINE_FLOWDB_USER <span class="o">||</span> <span class="nb">true</span>
docker secret rm FLOWAPI_FLOWDB_PASSWORD <span class="o">||</span> <span class="nb">true</span>
docker secret rm FLOWAPI_FLOWDB_USER <span class="o">||</span> <span class="nb">true</span>
docker secret rm POSTGRES_PASSWORD <span class="o">||</span> <span class="nb">true</span>
docker secret rm cert-flowkit.pem <span class="o">||</span> <span class="nb">true</span>
docker secret rm JWT_SECRET_KEY <span class="o">||</span> <span class="nb">true</span>
docker secret rm REDIS_PASSWORD <span class="o">||</span> <span class="nb">true</span>
docker secret rm FLOWAPI_IDENTIFIER <span class="o">||</span> <span class="nb">true</span>

<span class="nb">echo</span> <span class="s2">&quot;Adding secrets&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;flowmachine&quot;</span> <span class="p">|</span> docker secret create FLOWMACHINE_FLOWDB_USER -
openssl rand -base64 <span class="m">16</span> <span class="p">|</span> tr -cd <span class="s1">&#39;0-9-a-z-A-Z&#39;</span> <span class="se">\</span>
    <span class="p">|</span> docker secret create FLOWMACHINE_FLOWDB_PASSWORD -
<span class="nb">echo</span> <span class="s2">&quot;flowapi&quot;</span> <span class="p">|</span> docker secret create FLOWAPI_FLOWDB_USER -
openssl rand -base64 <span class="m">16</span> <span class="p">|</span> tr -cd <span class="s1">&#39;0-9-a-z-A-Z&#39;</span> <span class="p">|</span> docker secret create FLOWAPI_FLOWDB_PASSWORD -
openssl rand -base64 <span class="m">16</span> <span class="p">|</span> tr -cd <span class="s1">&#39;0-9-a-z-A-Z&#39;</span> <span class="p">|</span> docker secret create POSTGRES_PASSWORD -
openssl rand -base64 <span class="m">16</span> <span class="p">|</span> tr -cd <span class="s1">&#39;0-9-a-z-A-Z&#39;</span> <span class="p">|</span> docker secret create REDIS_PASSWORD -
<span class="nb">echo</span> <span class="s2">&quot;flowapi_server&quot;</span> <span class="p">|</span> docker secret create FLOWAPI_IDENTIFIER -
openssl req -newkey rsa:4096 -days <span class="m">3650</span> -nodes -x509 -subj <span class="s2">&quot;/CN=flow.api&quot;</span> <span class="se">\</span>
    -extensions SAN <span class="se">\</span>
    -config &lt;<span class="o">(</span> <span class="se">\</span>
        cat <span class="k">$(</span>   <span class="o">(</span> <span class="o">[[</span> -e /System/Library/OpenSSL/openssl.cnf <span class="o">]]</span> <span class="se">\</span>
                   <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;/System/Library/OpenSSL/openssl.cnf&quot;</span> <span class="k">)</span> <span class="se">\</span>
              <span class="o">||</span> <span class="o">(</span> <span class="o">[[</span> -e /etc/ssl/openssl.cnf <span class="o">]]</span> <span class="se">\</span>
                   <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;/etc/ssl/openssl.cnf&quot;</span> <span class="o">)</span> <span class="se">\</span>
              <span class="o">||</span> <span class="o">(</span> <span class="o">[[</span> -e /etc/pki/tls/openssl.cnf <span class="o">]]</span> <span class="se">\</span>
                   <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;/etc/pki/tls/openssl.cnf&quot;</span> <span class="o">)</span> <span class="o">)</span> <span class="se">\</span>
    &lt;<span class="o">(</span><span class="nb">printf</span> <span class="s2">&quot;[SAN]\nsubjectAltName=&#39;DNS.1:localhost,DNS.2:flow.api&#39;&quot;</span><span class="o">))</span> <span class="se">\</span>
    -keyout cert.key -out cert.pem
<span class="c1"># NOTE: make sure that the previous command generated _both_ files cert.key and cert.pem</span>
cat cert.key cert.pem &gt; cert-flowkit.pem
docker secret create cert-flowkit.pem cert-flowkit.pem
<span class="nb">echo</span> <span class="s2">&quot;secret&quot;</span> <span class="p">|</span> docker secret create JWT_SECRET_KEY -

<span class="nb">echo</span> <span class="s2">&quot;Deploying stack&quot;</span>
docker stack deploy --with-registry-auth -c docker-stack.yml secrets_test
</pre></div>

<p>This will bring up a single node swarm, create random 16 character passwords for the database users, generate a certificate valid for the <code>flowkit.api</code> domain (and point that to <code>localhost</code> using <code>/etc/hosts</code>), pull all necessary containers, and bring up the API with <code>secret</code> as the JWT secret key.</p>
<p>For convenience, you can also do <code>pipenv run secrets_quickstart</code> from the <code>secrets_quickstart</code> directory.</p>
<p>Note that if you wish to deploy a branch other than master, you should set the <code>CIRCLE_BRANCH</code> environment variable before running, to ensure that Docker pulls the correct tags.</p>
<p>You can then provide the certificate to <code>flowclient</code>, and finally connect via https:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">flowclient</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">flowclient</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://localhost:9090&quot;</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="s2">&quot;JWT_STRING&quot;</span><span class="p">,</span> <span class="n">ssl_certificate</span><span class="o">=</span><span class="s2">&quot;&lt;path_to_cert.pem&gt;&quot;</span><span class="p">)</span>
</pre></div>

<p>(This generates a certificate valid for the <code>flow.api</code> domain as well, which you can use by adding a corresponding entry to your <code>/etc/hosts</code> file.)</p>
<h3 id="demonstrating-successful-deployment">Demonstrating successful deployment<a class="headerlink" href="#demonstrating-successful-deployment" title="Permanent link">&para;</a></h3>
<p>Once FlowKit installation is complete, we suggest running the provided <a href="../worked_examples/">worked examples</a> against the deployed FlowKit to check that everything is working correctly.</p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href=".." title="Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Introduction</span></div></a><a href="../analyst/" title="Analyst" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Analyst</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div><div class="md-footer-social"><link rel="stylesheet" href="../assets/fonts/font-awesome.css"> <a href="https://github.com/Flowminder" class="md-footer-social__link fa fa-github"></a>  <a href="https://twitter.com/Flowminder" class="md-footer-social__link fa fa-twitter"></a> </div></div></div></footer></div><script src="../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:".."}})</script><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script></body></html>
