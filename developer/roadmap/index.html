



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Developer - FlowKit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/mermaid@7.1.2/dist/mermaid.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="#095798" data-md-color-accent="#2977b8">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#information-for-developers" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="FlowKit" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                FlowKit
              </span>
              <span class="md-header-nav__topic">
                Developer
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/Flowminder/FlowKit" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Flowminder/FlowKit
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Introduction" class="md-tabs__link md-tabs__link--active">
        Introduction
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="FlowKit" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    FlowKit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Flowminder/FlowKit" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Flowminder/FlowKit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../flowclient/" title="Analyst" class="md-nav__link">
      Analyst
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Developer
      </label>
    
    <a href="./" title="Developer" class="md-nav__link md-nav__link--active">
      Developer
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#roadmap" title="Roadmap" class="md-nav__link">
    Roadmap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#now" title="Now" class="md-nav__link">
    Now
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next" title="Next" class="md-nav__link">
    Next
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#later" title="Later" class="md-nav__link">
    Later
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributing" title="Contributing" class="md-nav__link">
    Contributing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-involved" title="Get involved" class="md-nav__link">
    Get involved
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-contributions" title="Code contributions" class="md-nav__link">
    Code contributions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flowapi-guide" title="FlowAPI Guide" class="md-nav__link">
    FlowAPI Guide
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-routes" title="API Routes" class="md-nav__link">
    API Routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flowapi-access-tokens" title="FlowAPI Access tokens" class="md-nav__link">
    FlowAPI Access tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flowmachine" title="FlowMachine" class="md-nav__link">
    FlowMachine
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation" title="Documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flowdb" title="FlowDB" class="md-nav__link">
    FlowDB
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#caveats" title="Caveats" class="md-nav__link">
    Caveats
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shared-memory" title="Shared Memory" class="md-nav__link">
    Shared Memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind-mounts-and-user-permissions" title="Bind Mounts and User Permissions" class="md-nav__link">
    Bind Mounts and User Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../administrator/cache_management/" title="Administrator" class="md-nav__link">
      Administrator
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#roadmap" title="Roadmap" class="md-nav__link">
    Roadmap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#now" title="Now" class="md-nav__link">
    Now
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next" title="Next" class="md-nav__link">
    Next
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#later" title="Later" class="md-nav__link">
    Later
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributing" title="Contributing" class="md-nav__link">
    Contributing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-involved" title="Get involved" class="md-nav__link">
    Get involved
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-contributions" title="Code contributions" class="md-nav__link">
    Code contributions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flowapi-guide" title="FlowAPI Guide" class="md-nav__link">
    FlowAPI Guide
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-routes" title="API Routes" class="md-nav__link">
    API Routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flowapi-access-tokens" title="FlowAPI Access tokens" class="md-nav__link">
    FlowAPI Access tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flowmachine" title="FlowMachine" class="md-nav__link">
    FlowMachine
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation" title="Documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flowdb" title="FlowDB" class="md-nav__link">
    FlowDB
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#caveats" title="Caveats" class="md-nav__link">
    Caveats
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shared-memory" title="Shared Memory" class="md-nav__link">
    Shared Memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind-mounts-and-user-permissions" title="Bind Mounts and User Permissions" class="md-nav__link">
    Bind Mounts and User Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="information-for-developers">Information for Developers<a class="headerlink" href="#information-for-developers" title="Permanent link">&para;</a></h1>
<p>Because FlowKit deployment is primarily done using Docker, the installation for developers is slightly different, see the instructions <a href="../../install/">here</a>. </p>
<p>An outline roadmap is provided below together with details about <a href="#contrib">contributing to the project</a>.</p>
<p>Followed by a guide to the <a href="#flowapi">FlowAPI</a>. </p>
<p>FlowMachine specifications are found <a href="#flowmachine">here</a>.</p>
<p>FlowDB details are found <a href="#flowdb">here</a>.</p>
<p><a href="roadmap"></a></p>
<h2 id="roadmap">Roadmap<a class="headerlink" href="#roadmap" title="Permanent link">&para;</a></h2>
<h3 id="now">Now<a class="headerlink" href="#now" title="Permanent link">&para;</a></h3>
<ul>
<li>More secure method for linking FlowAuth and FlowMachine</li>
<li>Additional home location aggregate</li>
<li>Work locations aggregate</li>
<li>Benchmarking</li>
<li>Cache management</li>
<li>Audit logs</li>
<li>Support for downloading geographies via API</li>
</ul>
<h3 id="next">Next<a class="headerlink" href="#next" title="Permanent link">&para;</a></h3>
<ul>
<li>Additional FlowMachine aggregates exposed via API</li>
<li>FlowMachine library release</li>
<li>Additional language targets for FlowClient</li>
<li>Expanded worked examples</li>
<li>Two-factor authentication support for FlowAuth</li>
<li>Alternative login provider support for FlowAuth</li>
<li>Interactive API specification</li>
<li>Custom geography support</li>
</ul>
<h3 id="later">Later<a class="headerlink" href="#later" title="Permanent link">&para;</a></h3>
<ul>
<li>New metrics and insights</li>
<li>Plugin support</li>
<li>Non-spatial aggregations</li>
<li>Enhanced temporal aggregations</li>
<li>Individual level API</li>
<li>Data source input/output connectors</li>
</ul>
<p><a name="contrib"></a>
<p>
<p></p>
<h3 id="contributing">Contributing<a class="headerlink" href="#contributing" title="Permanent link">&para;</a></h3>
<p>We are creating FlowKit at <a href="http://flowminder.org">Flowminder</a>.</p>
<h4 id="get-involved">Get involved<a class="headerlink" href="#get-involved" title="Permanent link">&para;</a></h4>
<p>You are welcome to contribute to the FlowKit library. To get started:  </p>
<ol>
<li>Check <a href="https://github.com/Flowminder/FlowKit/issues">Issues</a> to see what we are working on right now.  </li>
<li>Express your interest in a particular <a href="https://github.com/Flowminder/FlowKit/issues">issue</a> by submitting a comment, or submit your own <a href="https://github.com/Flowminder/FlowKit/issues">issue</a>.</li>
<li>We will get back to you about working together.</li>
</ol>
<h4 id="code-contributions">Code contributions<a class="headerlink" href="#code-contributions" title="Permanent link">&para;</a></h4>
<p>If you plan to make a major contribution, please create a <a href="https://github.com/Flowminder/FlowKit/pulls">pull request</a> with the feature or bug fix.</p>
<p><a name="flowapi"></a></p>
<h2 id="flowapi-guide">FlowAPI Guide<a class="headerlink" href="#flowapi-guide" title="Permanent link">&para;</a></h2>
<p>This section describes the FlowAPI routes.</p>
<p>FlowAPI is an HTTP API which provides access to the functionality of <a href="#flowmachine">FlowMachine</a>.</p>
<p>FlowAPI uses <a href="http://zeromq.org/">ZeroMQ</a> for asynchronous communication with the FlowMachine server.</p>
<h3 id="api-routes">API Routes<a class="headerlink" href="#api-routes" title="Permanent link">&para;</a></h3>
<p>The API exposes four routes:</p>
<ul>
<li>
<p><code>/run</code>: set a query running in FlowMachine.</p>
</li>
<li>
<p><code>/poll/&lt;query_id&gt;</code>: get the status of a query.</p>
</li>
<li>
<p><code>/get/&lt;query_id&gt;</code>: return the result of a finished query.</p>
</li>
<li>
<p><code>/geography/&lt;aggregation_unit&gt;</code>: return geography data for a given aggregation unit.</p>
</li>
</ul>
<p>At present, four query types are accessible through FlowAPI:</p>
<ul>
<li>
<p><code>daily_location</code></p>
<p>A statistic representing where subscribers are on a given day, aggregated to a spatial location level.</p>
</li>
<li>
<p><code>modal_location</code></p>
<p>The mode of a set of daily locations.</p>
</li>
<li>
<p><code>flows</code></p>
<p>The difference in locations between two location queries.</p>
</li>
<li>
<p><code>location_event_counts</code></p>
<p>Count of total interactions in a time period, aggregated to a spatial location level.</p>
</li>
</ul>
<h3 id="flowapi-access-tokens">FlowAPI Access tokens<a class="headerlink" href="#flowapi-access-tokens" title="Permanent link">&para;</a></h3>
<p>As explained in the <a href="../../install/">quick install guide</a>, user authentication and access control are handled through the use of <a href="http://jwt.io">JSON Web Tokens (JWT)</a>. There are two categories of permissions which can be granted to a user:</p>
<ul>
<li>
<p>API route permissions</p>
<p>API routes (<code>run</code>, <code>poll</code>, <code>get_result</code>) the user is allowed to access.</p>
</li>
<li>
<p>Spatial aggregation unit permissions</p>
<p>Level of spatial aggregation at which the user is allowed to access the results of queries. Currently supports administrative levels <code>admin0</code>, <code>admin1</code>, <code>admin2</code>, <code>admin3</code>.</p>
</li>
</ul>
<p>JWTs allow these access permissions to be granted independently for each query kind (e.g. <code>daily_location</code>, <code>modal_location</code>). The <a href="../../flowauth/">FlowAuth</a> authentication management system is designed to generate JWTs for accessing FlowAPI.</p>
<p><a name="flowmachine"></p>
<h2 id="flowmachine">FlowMachine<a class="headerlink" href="#flowmachine" title="Permanent link">&para;</a></h2>
<p>FlowMachine is a Python toolkit for the analysis of CDR data. It is essentially a python wrapper for postgres SQL queries, including geographical queries with postgis. All of the classes in flowmachine define an SQL query under the hood.</p>
<h3 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h3>
<p>Documentation for FlowMachine can be found <a href="../../developer/api/flowmachine">here</a>.</p>
<p><a name="flowdb"></p>
<h2 id="flowdb">FlowDB<a class="headerlink" href="#flowdb" title="Permanent link">&para;</a></h2>
<p>FlowDB is database designed for storing, serving, and analysing mobile operator data. The project's main features are:</p>
<ul>
<li>Uses standard schema for most common mobile operator data</li>
<li>Is built as a <a href="http://docker.com/">Docker</a> container</li>
<li>Uses <a href="https://www.postgresql.org/docs/11/static/release-11.html">PostgreSQL 11</a></li>
<li>Grants different permissions for users depending on need</li>
<li>Is configured for high-performance operations</li>
<li>Comes with<ul>
<li><a href="https://postgis.net">PostGIS</a> for geospatial data handling and analysis</li>
<li><a href="http://pgrouting.org">pgRouting</a> for advanced spatial analysis</li>
<li>Utilities for connecting with Oracle databases (<a href="https://github.com/laurenz/oracle_fdw">oracle_fdw</a>)</li>
<li>Scheduled tasks run in database (<a href="https://github.com/citusdata/pg_cron">pg_cron</a>)</li>
</ul>
</li>
</ul>
<h3 id="caveats">Caveats<a class="headerlink" href="#caveats" title="Permanent link">&para;</a></h3>
<h4 id="shared-memory">Shared Memory<a class="headerlink" href="#shared-memory" title="Permanent link">&para;</a></h4>
<p>You will typically need to increase the default shared memory available to docker containers when running FlowDB. You can do this either by setting <code>shm_size</code> for the FlowDB container in your compose or stack file, or by passing the <code>--shm-size</code> argument to the <code>docker run</code> command.</p>
<h4 id="bind-mounts-and-user-permissions">Bind Mounts and User Permissions<a class="headerlink" href="#bind-mounts-and-user-permissions" title="Permanent link">&para;</a></h4>
<p>By default, FlowDB will create and attach a docker volume that contains all data. In some cases, this will be sufficient for use.</p>
<p>However, you will often wish to set up bind mounts to hold the data and allow FlowDB to consume new data. To avoid sticky situations with permissions, you will want to specify the uid and gid that FlowDB runs with to match an existing user on the host system.</p>
<p>Adding a bind mount using <code>docker-compose</code> is simple:</p>
<div class="codehilite"><pre><span></span><span class="nt">services</span><span class="p">:</span>
    <span class="nt">flowdb</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
        <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">HOST_USER_ID:HOST_GROUP_ID</span>
        <span class="l l-Scalar l-Scalar-Plain">volumes</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/store/data/on/host:/var/lib/postgresql/data</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/consume/data/from/host:/etl:ro</span>
</pre></div>

<p>This creates two bind mounts, the first is FlowDB's internal storage, and the second is a <em>read only</em> mount for loading new data. The user FlowDB runs as inside the container will also be changed to the uid specified. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the bind mounted directories do not exist, docker will create them and you will need to <code>chown</code> them to the correct user.</p>
</div>
<p>And similarly when using <code>docker run</code>:</p>
<div class="codehilite"><pre><span></span>docker run --name flowdb_testdata -e <span class="nv">FM_PASSWORD</span><span class="o">=</span>foo -e <span class="nv">API_PASSWORD</span><span class="o">=</span>foo <span class="se">\</span>
 --publish <span class="m">9000</span>:5432 <span class="se">\</span>
 --user HOST_USER_ID:HOST_GROUP_ID <span class="se">\</span>
 -v /path/to/store/data/on/host:/var/lib/postgresql/data <span class="se">\</span>
 -v /path/to/consume/data/from/host:/etl:ro <span class="se">\</span>
 --detach flowminder/flowdb:latest
</pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To run as the current user, you can simply replace <code>HOST_USER_ID:HOST_GROUP_ID</code> with <code>$(id -u):$(id -g)</code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using the <code>--user</code> flag without a bind mount specified will not work, and you will see an error
like this: <code>initdb: could not change permissions of directory "/var/lib/postgresql/data": Operation not permitted</code>.</p>
<p>When using docker volumes, docker will manage the permissions for you.</p>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../flowclient/" title="Analyst" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Analyst
              </span>
            </div>
          </a>
        
        
          <a href="../../administrator/cache_management/" title="Administrator" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Administrator
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/Flowminder" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/Flowminder" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
      
    
    
      
    
  </body>
</html>